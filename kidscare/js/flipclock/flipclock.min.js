var FlipClock;(function(a){FlipClock=function(c,d,b){return new FlipClock.Factory(c,d,b)};FlipClock.Lang={};FlipClock.Base=Base.extend({buildDate:"2013-11-07",version:"0.3.1",constructor:function(b,c){if(typeof b!=="object"){b={}}if(typeof c!=="object"){c={}}this.setOptions(a.extend(true,{},b,c))},callback:function(d){if(typeof d==="function"){var c=[];for(var b=1;b<=arguments.length;b++){if(arguments[b]){c.push(arguments[b])}}d.apply(this,c)}},log:function(b){if(window.console&&console.log){console.log(b)}},getOption:function(b){if(this[b]){return this[b]}return false},getOptions:function(){return this},setOption:function(b,c){this[b]=c},setOptions:function(b){for(var c in b){if(typeof b[c]!=="undefined"){this.setOption(c,b[c])}}}});FlipClock.Factory=FlipClock.Base.extend({autoStart:true,callbacks:{destroy:false,create:false,init:false,interval:false,start:false,stop:false,reset:false},classes:{active:"flip-clock-active",before:"flip-clock-before",divider:"flip-clock-divider",dot:"flip-clock-dot",label:"flip-clock-label",flip:"flip",play:"play",wrapper:"flip-clock-wrapper"},clockFace:"HourlyCounter",defaultClockFace:"HourlyCounter",defaultLanguage:"english",language:"english",lang:false,face:true,running:false,time:false,timer:false,lists:[],$wrapper:false,constructor:function(c,d,b){this.lists=[];this.running=false;this.base(b);this.$wrapper=a(c).addClass(this.classes.wrapper);this.time=new FlipClock.Time(this,d?Math.round(d):0);this.timer=new FlipClock.Timer(this,b);this.lang=this.loadLanguage(this.language);this.face=this.loadClockFace(this.clockFace,b);if(this.autoStart){this.start()}},loadClockFace:function(c,b){var d,e="Face";c=c.ucfirst()+e;if(FlipClock[c]){d=new FlipClock[c](this,b)}else{d=new FlipClock[this.defaultClockFace+e](this,b)}d.build();return d},loadLanguage:function(b){var c;if(FlipClock.Lang[b.ucfirst()]){c=FlipClock.Lang[b.ucfirst()]}else{if(FlipClock.Lang[b]){c=FlipClock.Lang[b]}else{c=FlipClock.Lang[this.defaultLanguage]}}return c},localize:function(b,d){var e=this.lang;var c=b.toLowerCase();if(typeof d=="object"){e=d}if(e&&e[c]){return e[c]}return b},start:function(c){var b=this;if(!b.running&&(!b.countdown||b.countdown&&b.time.time>0)){b.face.start(b.time);b.timer.start(function(){b.flip();if(typeof c==="function"){c()}})}else{b.log("Trying to start timer when countdown already at 0")}},stop:function(c){this.face.stop();this.timer.stop(c);for(var b in this.lists){this.lists[b].stop()}},reset:function(b){this.timer.reset(b);this.face.reset()},setTime:function(b){this.time.time=b;this.face.setTime(b)},getTime:function(b){return this.time},setCountdown:function(c){var b=this.running;this.countdown=c?true:false;if(b){this.stop();this.start()}},flip:function(){this.face.flip()}});FlipClock.Face=FlipClock.Base.extend({dividers:[],factory:false,lists:[],constructor:function(b,c){this.base(c);this.factory=b;this.dividers=[]},build:function(){},createDivider:function(b,d,e){if(typeof d=="boolean"||!d){e=d;d=b}var f=['<span class="'+this.factory.classes.dot+' top"></span>','<span class="'+this.factory.classes.dot+' bottom"></span>'].join("");if(e){f=""}b=this.factory.localize(b);var c=['<span class="'+this.factory.classes.divider+" "+(d?d:"").toLowerCase()+'">','<span class="'+this.factory.classes.label+'">'+(b?b:"")+"</span>",f,"</span>"];return a(c.join(""))},createList:function(d,b){if(typeof d==="object"){b=d;d=0}var c=new FlipClock.List(this.factory,d,b);return c},reset:function(){},setTime:function(b){this.flip(b)},addDigit:function(c){var b=this.createList(c,{classes:{active:this.factory.classes.active,before:this.factory.classes.before,flip:this.factory.classes.flip}});b.$obj.insertBefore(this.factory.lists[0].$obj);this.factory.lists.unshift(b)},start:function(){},stop:function(){},flip:function(g,e){var d=this;if(!e){if(!d.factory.countdown){d.factory.time.time++}else{if(d.factory.time.time<=0){d.factory.stop()}d.factory.time.time--}}var h=d.factory.lists.length-g.length;if(h<0){h=0}var f=0;var c=false;a.each(g,function(j,m){j+=h;var k=d.factory.lists[j];if(k){var l=k.digit;k.select(m);if(m!=l&&!e){k.play()}}else{d.addDigit(m);c=true}});for(var b=0;b<g.length;b++){if(b>=h&&d.factory.lists[b].digit!=g[b]){d.factory.lists[b].select(g[b])}}}});FlipClock.List=FlipClock.Base.extend({digit:0,classes:{active:"flip-clock-active",before:"flip-clock-before",flip:"flip"},factory:false,$obj:false,items:[],constructor:function(b,d,c){this.factory=b;this.digit=d;this.$obj=this.createList();if(d>0){this.select(d)}this.factory.$wrapper.append(this.$obj)},select:function(e){if(typeof e==="undefined"){e=this.digit}else{this.digit=e}var d=this.$obj.find('[data-digit="'+e+'"]');var c=this.$obj.find("."+this.classes.active).removeClass(this.classes.active);var b=this.$obj.find("."+this.classes.before).removeClass(this.classes.before);if(!this.factory.countdown){if(d.is(":first-child")){this.$obj.find(":last-child").addClass(this.classes.before)}else{d.prev().addClass(this.classes.before)}}else{if(d.is(":last-child")){this.$obj.find(":first-child").addClass(this.classes.before)}else{d.next().addClass(this.classes.before)}}d.addClass(this.classes.active)},play:function(){this.$obj.addClass(this.factory.classes.play)},stop:function(){var b=this;setTimeout(function(){b.$obj.removeClass(b.factory.classes.play)},this.factory.timer.interval)},createList:function(){var c=a('<ul class="'+this.classes.flip+" "+(this.factory.running?this.factory.classes.play:"")+'" />');for(var b=0;b<10;b++){var d=a(['<li data-digit="'+b+'">','<a href="#">','<div class="up">','<div class="shadow"></div>','<div class="inn">'+b+"</div>","</div>",'<div class="down">','<div class="shadow"></div>','<div class="inn">'+b+"</div>","</div>","</a>","</li>"].join(""));this.items.push(d);c.append(d)}return c}});FlipClock.Time=FlipClock.Base.extend({minimumDigits:0,time:0,factory:false,constructor:function(b,d,c){this.base(c);this.factory=b;if(d){this.time=d}},convertDigitsToArray:function(d){var c=[];d=d.toString();for(var b=0;b<d.length;b++){if(d[b].match(/^\d*$/g)){c.push(d[b])}}return c},digit:function(b){var d=this.toString();var c=d.length;if(d[c-b]){return d[c-b]}return false},digitize:function(c){var b=[];a.each(c,function(e,f){f=f.toString();if(f.length==1){f="0"+f}for(var d=0;d<f.length;d++){b.push(f[d])}});if(b.length>this.minimumDigits){this.minimumDigits=b.length}if(this.minimumDigits>b.length){b.unshift("0")}return b},getDayCounter:function(b){var c=[this.getDays(),this.getHours(true),this.getMinutes(true)];if(b){c.push(this.getSeconds(true))}return this.digitize(c)},getDays:function(b){var c=this.time/60/60/24;if(b){c=c%7}return Math.floor(c)},getHourCounter:function(){var b=this.digitize([this.getHours(),this.getMinutes(true),this.getSeconds(true)]);return b},getHourly:function(){return this.getHourCounter()},getHours:function(c){var b=this.time/60/60;if(c){b=b%24}return Math.floor(b)},getMilitaryTime:function(){var b=new Date();var c=this.digitize([b.getHours(),b.getMinutes(),b.getSeconds()]);return c},getMinutes:function(c){var b=this.time/60;if(c){b=b%60}return Math.floor(b)},getMinuteCounter:function(){var b=this.digitize([this.getMinutes(),this.getSeconds(true)]);return b},getSeconds:function(b){var c=this.time;if(b){if(c==60){c=0}else{c=c%60}}return Math.ceil(c)},getTime:function(){var c=new Date();var b=c.getHours();var d=b>12?"PM":"AM";var e=this.digitize([b>12?b-12:(b===0?12:b),c.getMinutes(),c.getSeconds()]);return e},getWeeks:function(){var b=this.time/60/60/24/7;if(mod){b=b%52}return Math.floor(b)},removeLeadingZeros:function(c,e){var d=0;var b=[];a.each(e,function(f,g){if(f<c){d+=parseInt(e[f],10)}else{b.push(e[f])}});if(d===0){return b}return e},toString:function(){return this.time.toString()}});FlipClock.Timer=FlipClock.Base.extend({callbacks:{destroy:false,create:false,init:false,interval:false,start:false,stop:false,reset:false},count:0,factory:false,interval:1000,constructor:function(b,c){this.base(c);this.factory=b;this.callback(this.callbacks.init);this.callback(this.callbacks.create)},getElapsed:function(){return this.count*this.interval},getElapsedTime:function(){return new Date(this.time+this.getElapsed())},reset:function(b){clearInterval(this.timer);this.count=0;this._setInterval(b);this.callback(this.callbacks.reset)},start:function(b){this.factory.running=true;this._createTimer(b);this.callback(this.callbacks.start)},stop:function(b){this.factory.running=false;this._clearInterval(b);this.callback(this.callbacks.stop);this.callback(b)},_clearInterval:function(){clearInterval(this.timer)},_createTimer:function(b){this._setInterval(b)},_destroyTimer:function(b){this._clearInterval();this.timer=false;this.callback(b);this.callback(this.callbacks.destroy)},_interval:function(b){this.callback(this.callbacks.interval);this.callback(b);this.count++},_setInterval:function(c){var b=this;b.timer=setInterval(function(){b._interval(c)},this.interval)}});String.prototype.ucfirst=function(){return this.substr(0,1).toUpperCase()+this.substr(1)};a.fn.FlipClock=function(c,b){if(typeof c=="object"){b=c;c=0}return new FlipClock(a(this),c,b)};a.fn.flipClock=function(c,b){return a.fn.FlipClock(c,b)}}(jQuery));